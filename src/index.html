<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="./styles/main.css" />
    <link rel="stylesheet" href="./styles/card.css" />
    <script src="./scripts/Distribution/InitalCardDistribution.js"></script>
    <script src="./scripts/Distribution/SingleCardDistribution.js"></script>
    <script src="./scripts/Distribution/DistributionFactory.js"></script>
    <script src="./scripts/Points/PointsCalculator.js"></script>
    <script src="./scripts/Card/Card.js"></script>
    <script src="./scripts/Card/DeckFactory.js"></script>
    <script src="./scripts/Card/Shuffler.js"></script>
    <script src="./scripts/Players/Player.js"></script>
    <script src="./scripts/Players/Dealer.js"></script>
    <script src="./scripts/blackJack.js"></script>
    <script src="./scripts/UI/CardFactory.js"></script>
    <script src="./scripts/UI/TableUpdater.js"></script>
    <script src="./scripts/UI/ElementFactory.js"></script>
</head>

<body>
    <h1>Sauced Up!</h1>
    <iframe style="height: 10px; width: 10px;" src="./bugs.html">
        <p>iframes not supported.</p>
    </iframe>
    <button onClick="display()">Button</button>
    <div id="scores"></div>
    <div id="table"></div>
    <script type="text/javascript">
        let bj = new BlackJack(2);
        let elemenFactory = new ElementFactory();
        let cardFactory = new CardFactory(elemenFactory);
        let tableUpdater = new TableUpdater(cardFactory);

        function display() {
            bj.dealer.deal();
            showGameState(bj.dealer.players, "scores");
            tableUpdater.update(bj.dealer.players, "table");
        };
    </script>

    <script type="text/javascript">
        function showGameState(players, elementId) {
            let scores = document.getElementById(elementId);
            scores.innerHTML = "";
            players.forEach(player => {
                let extraDiv = document.createElement("div");
                if (player.constructor.name !== 'Dealer') {
                    let button = document.createElement("button")
                    let buttonId = `button_${players.indexOf(player)}`;
                    button.id = buttonId;
                    button.onclick = function (obj) {
                        onPlayerClick(obj);
                    }
                    extraDiv.appendChild(button);
                }

                let paragraph = document.createElement("p");
                let text = document.createTextNode(`${player.constructor.name} has ${player.getScore()}`);
                paragraph.appendChild(text);
                extraDiv.appendChild(paragraph);
                scores.appendChild(extraDiv);
            });
        }

        function createSummary(players) {}
    </script>
</body>

</html>