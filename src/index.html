<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="./styles/main.css" />
    <link rel="stylesheet" href="./styles/card.css" />
    <link rel="stylesheet" href="./styles/border.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fjalla+One">
    <script src="./scripts/Distribution/InitalCardDistribution.js"></script>
    <script src="./scripts/Distribution/SingleCardDistribution.js"></script>
    <script src="./scripts/Distribution/DistributionFactory.js"></script>
    <script src="./scripts/Points/PointsCalculator.js"></script>
    <script src="./scripts/Card/Card.js"></script>
    <script src="./scripts/Card/DeckFactory.js"></script>
    <script src="./scripts/Card/Shuffler.js"></script>
    <script src="./scripts/Players/Player.js"></script>
    <script src="./scripts/Players/Dealer.js"></script>
    <script src="./scripts/blackJack.js"></script>
    <script src="./scripts/GameState/BlackJackGameState.js"></script>
    <script src="./scripts/GameState/StateFormatter.js"></script>
    <script src="./scripts/UI/CardFactory.js"></script>
    <script src="./scripts/UI/TableUpdater.js"></script>
    <script src="./scripts/UI/ElementFactory.js"></script>
    <script src="./scripts/UI/SummaryUpdater.js"></script>
    <script src="./scripts/UI/PlayerFactory.js"></script>
    <script src="./scripts/Players/HitCalculator/CalculateHitStrategyFactory.js"></script>
    <script src="./scripts/Players/HitCalculator/CalculateHitStrategy.js"></script>
    <script src="./scripts/Players/HitCalculator/HitDealer.js"></script>
    <script src="./scripts/Players/HitCalculator/HitPlayer.js"></script>
</head>

<body>
    <a class="dealButton hitMeButton" onClick="display()">Deal</a>
    <a class="dealButton hitMeButton" onClick="reset()">Reset</a>
    <div id="scores"></div>
    <div id="table"></div>
    <script type="text/javascript">
        //todo
        //this needs to be moved out into its own script so that the ui has a simple initalise method
        let bj = new BlackJack(2);
        let elementFactory = new ElementFactory();
        let cardFactory = new CardFactory(elementFactory);
        let tableUpdater = new TableUpdater(cardFactory, elementFactory);
        let playerFactory = new PlayerFactory(elementFactory);
        let summaryUpdater = new SummaryUpdater(elementFactory, playerFactory);

        //todo remove into its own script file
        function reset() {
            bj = new BlackJack(2);
            display();
        }

        function display() {
            //todo
            //this needs to move out of here into its own class
            bj.playRound();
            summaryUpdater.update(bj.players, "scores");
            tableUpdater.update(bj.players, "table");
        };

        //todo:
        //remove into its own script file
        function updateButton(event) {
            let elementId = event.currentTarget.id;
            let playerId = elementId
                .replace('player-', '')
                .replace('-button', '');
            let players = bj.players;
            let player = players[playerId];
            player.hit = !player.hit;
            summaryUpdater.update(bj.players, "scores");
        };
    </script>
</body>

</html>